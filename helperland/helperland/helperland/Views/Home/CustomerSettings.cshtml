@using Microsoft.AspNetCore.Http
@using helperland.Models.Data
@inject IHttpContextAccessor HttpContextAccessor
@model helperland.Models.CustomerSettingsModel

@{
    ViewData["Title"] = "My Account";
    Layout = "~/Views/Shared/_Layout1.cshtml";
}
 <div id="deleteadd" class="modal">
  
        <form class="modal-content animate" asp-action="deleteaddress">
          <input type="hidden"  id="serviceReqId1"/>
            <p class="login">Delete Address <i class="fa fa-close float-right" 
                onclick="document.getElementById('deleteadd').style.display='none'"></i></p>
          <div class="container">
            <input type="hidden" id="deleteaddid" asp-for="deleteaddid"/>
            <span class="psw " style="color:#646464">Are you sure you want to delete this Address?</span>
              <div class="text-center">
               <img src="~/assets/alert1.jpg" width="120" height="120">
                  <button type="submit" class="btn login-btn" >Delete Now</button>
              </div>
            </div>
        </form>
      </div>

          <div id="add" class="modal ">
            
            <form class="modal-content animate edit-address" asp-action="AddNewAddress">
                 <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <p class="login">Add New Address <i class="fa fa-close float-right" 
                    onclick="document.getElementById('add').style.display='none'"></i></p>
                    
                        
                   <div class="container">
                      
                    <div class="form-row">
                        <div class="col">
                          <label>Street Name</label>
                      <input type="text" asp-for="myaddress.AddressLine2"  class="form-control add-form-input" placeholder="Street Name"  >
                      <span asp-validation-for="myaddress.AddressLine2" class="text-danger"></span>
                      
                    </div>
                    <div class="col">
                      <label>House Number</label>
                      <input type="text" asp-for="myaddress.AddressLine1" class="form-control add-form-input" placeholder="House Number"  >
                       <span asp-validation-for="myaddress.AddressLine1" class="text-danger"></span>
                    </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                          <label>Postal code</label>
                      <input type="text" asp-for="myaddress.PostalCode" class="form-control add-form-input"  placeholder="Postal Code"  >
                       <span asp-validation-for="myaddress.PostalCode" class="text-danger"></span>
                    </div>
                    <div class="col">
                      <label>City</label>
                      <input type="text" asp-for="myaddress.City" class="form-control add-form-input"  placeholder="City"  >
                    
                       <span asp-validation-for="myaddress.City" class="text-danger"></span>
                    </div>
                    </div>
                      <div class="form-row ">
                          <div class="col ">
                            <label>Phone Number</label>
                              <div class="input-group mb-2">
                              <div class="input-group-prepend">
                                  <div class="input-group-text">+91</div>
                                </div>
                                <input asp-for="myaddress.Mobile" class="form-control" id="myphone" placeholder="Phone Number"
                                 >
                              </div>
                        
                      </div>
                      <div class="col"></div>                               
                      </div>
                  <div class="container text-center">
                   
                    <button type="submit"  class="btn login-btn" >Add</button>
                 </div>
                   </div>
                
                    
            </form>
          </div>
<div class="service-history">
      <div class="container-fluid"><p class="text-center" >Welcome,<span>@HttpContextAccessor.HttpContext.Session.GetString("Customerfname")</span></p></div>
        
        <div class="line"></div>
        <div class=" dropdown ">
          <a class="nav-link dropdown-toggle " href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <i class="fa fa-fw fa-arrow-circle-right "></i>
          </a>
          <div class="dropdown-menu " aria-labelledby="navbarDropdown">
            <a class="dropdown-item" asp-action="Welcome">Dashboard</a>
            
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Service History</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item"  asp-action="ServiceHistory">Service Schedule</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Favorite Pros</a>
            
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Invoice</a>
            <div class="dropdown-divider"></div>
            <a class="dropdown-item" href="#">Notification</a>
          </div>
          </div>
        <div class="history-container">
          <div class="container">
            <div class="row">
              <div class="buttons" >
               <form  asp-action="Welcome">
                    <button type="submit" class="btn ">Dashboard</button>
               </form>
                 
                
                <div class="border border-top-1 border-right-0 border-left-0 border-bottom-0"></div>
                 <form  asp-action="ServiceHistory">
                     <button type="submit" class="btn ">Service History</button>
                 </form>
                  
                
                  <div class="border border-top-1 border-right-0 border-left-0 border-bottom-0"></div>
                
                  <button type="button" class="btn ">Service Schedule</button>
                
                  <div class="border border-top-1 border-right-0 border-left-0 border-bottom-0"></div>
                <button type="button" class="btn ">Favorite Pros</button>
                <div class="border border-top-1 border-right-0 border-left-0 border-bottom-0"></div>
                <button type="button" class="btn ">Invoice</button>
                <div class="border border-top-1 border-right-0 border-left-0 border-bottom-0"></div>
                <button type="button" class="btn ">Notifications</button>
                <div class="border border-top-1 border-right-0 border-left-0 border-bottom-0"></div>
              </div>
              <div class="col-lg-8 col-md-9">
                <div class="settings">
                  <ul class="row nav nav-tabs nav-fill" id="myTab" role="tablist">
                    <li class="nav-item " role="presentation">
                      <a class="nav-link active"  id="customer" data-toggle="tab" href="#home" role="tab" aria-controls="home" 
                      aria-selected="true">My Details</a>
                    </li>
                    <li class="nav-item" role="presentation">
                      <a class="nav-link" id="service-provider" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" 
                      aria-selected="false">My Addresses</a>
                    </li>
                    <li class="nav-item" role="presentation">
                        <a class="nav-link" id="hello1" data-toggle="tab" href="#hello" role="tab" aria-controls="hello" 
                        aria-selected="false">Change Password</a>
                      </li>
                  </ul>
                <div class="tab-content" id="myTabContent">
                  <div class="tab-pane fade show active " id="home" role="tabpanel" aria-labelledby="customer">
                      <div role="alert" class="alert alert-success " id="closebtn">
                      <button  class="close" type="button" onclick="document.getElementById('closebtn').style.display='none'">
                        <span aria-hidden="true">×</span>
                      </button>
                      <span class="break-word" id="mymessage">Updated Successfully!!</span>
                    </div>
                    <form  class="ng-untouched ng-pristine ng-valid" asp-action="customersettingstab1">
                        <div class="row">
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label mt-3">First name</label>
                              <input class="form-control ng-untouched ng-pristine ng-valid" formcontrolname="FirstName" maxlength="100"
                                placeholder="First name" asp-for="fname" value="@ViewBag.personal.FirstName">
                              <!---->
                            </div>
                          </div>
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label mt-3">Last name</label>
                              <input class="form-control ng-untouched ng-pristine ng-valid" formcontrolname="LastName" maxlength="100" 
                               placeholder="Last name" asp-for="lname" value="@ViewBag.personal.LastName">
                              <!---->
                            </div>
                          </div>
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label mt-3">E-mail address</label>
                              <input class="form-control ng-untouched ng-pristine ng-valid" disabled="" formcontrolname="Email" 
                               type="text" placeholder="E-mail address" value="@ViewBag.personal.Email">
                              <!---->
                            </div>
                          </div>
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label">Mobile number</label>
                              
                                <div class="input-group mb-2">
                                <div class="input-group-prepend">
                                    <div class="input-group-text">+91</div>
                                  </div>
                                  <input  asp-for="phone" class="form-control" id="myphone"  placeholder="Mobile number"
                                    value="@ViewBag.personal.Mobile">
                                </div>
                         
                        
                              <!---->
                            </div>
                          </div>
                          <div class="col">
                            <div class="form-group date-group">
                              <label class="control-label">Date of Birth</label>
                              <div class="inner-wrapper row">
                                <div class="inner">
                                  <select asp-for="day" class="form-control ng-untouched ng-pristine ng-valid" formcontrolname="DateOfBirthDay">
                                                            @if (ViewBag.personal.DateOfBirth != null)
                                                            {
                                                                <option value="">@ViewBag.personal.DateOfBirth.Day</option>
                                                            }
                                                            else
                                                            {
                                                                 <option value="">Day</option>
                                                            }
                                                           
                                    <option value="1">01</option>
                                    <option value="2">02</option>
                                    <option value="3">03</option>
                                    <option value="4">04</option>
                                    <option value="5">05</option>
                                    <option value="6">06</option>
                                    <option value="7">07</option>
                                    <option value="8">08</option>
                                    <option value="9">09</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                    <option value="13">13</option>
                                    <option value="14">14</option>
                                    <option value="15">15</option>
                                    <option value="16">16</option>
                                    <option value="17">17</option>
                                    <option value="18">18</option>
                                    <option value="19">19</option>
                                    <option value="20">20</option>
                                    <option value="21">21</option>
                                    <option value="22">22</option>
                                    <option value="23">23</option>
                                    <option value="24">24</option>
                                    <option value="25">25</option>
                                    <option value="26">26</option>
                                    <option value="27">27</option>
                                    <option value="28">28</option>
                                    <option value="29">29</option>
                                    <option value="30">30</option>
                                    <option value="31">31</option>
                                  </select>
                                </div>
                                <div class="inner1">
                                  <select asp-for="month" class="form-control ng-untouched ng-pristine ng-valid" formcontrolname="DateOfBirthMonth">
                                       @if (ViewBag.personal.DateOfBirth != null)
                                                            {
                                                                <option value="">@ViewBag.personal.DateOfBirth.ToString("MMMM")</option>
                                                            }
                                                            else
                                                            {
                                                                <option value="">Month</option>
                                                            }
                                                            
                                    <option value="1">January</option>
                                    <option value="2">February</option>
                                    <option value="3">March</option>
                                    <option value="4">April</option>
                                    <option value="5">May</option>
                                    <option value="6">June</option>
                                    <option value="7">July</option>
                                    <option value="8">August</option>
                                    <option value="9">September</option>
                                    <option value="10">October</option>
                                    <option value="11">November</option>
                                    <option value="12">December</option>
                                  </select>
                                </div>
                                <div class="inner1">
                                  <select asp-for="year" class="form-control ng-untouched ng-pristine ng-valid" formcontrolname="DateOfBirthYear">
                                       @if (ViewBag.personal.DateOfBirth != null)
                                                            {
                                                                 <option value="">@ViewBag.personal.DateOfBirth.Year</option>
                                                            }
                                                            else
                                                            {
                                                                 <option value="">Year</option>
                                                            }
                                                           
                                    <!----><option value="2012">2012</option><option value="2011">2011</option><option value="2010">2010</option><option value="2009">2009</option><option value="2008">2008</option><option value="2007">2007</option><option value="2006">2006</option><option value="2005">2005</option><option value="2004">2004</option><option value="2003">2003</option><option value="2002">2002</option><option value="2001">2001</option><option value="2000">2000</option><option value="1999">1999</option><option value="1998">1998</option><option value="1997">1997</option><option value="1996">1996</option><option value="1995">1995</option><option value="1994">1994</option><option value="1993">1993</option><option value="1992">1992</option><option value="1991">1991</option><option value="1990">1990</option><option value="1989">1989</option><option value="1988">1988</option><option value="1987">1987</option><option value="1986">1986</option><option value="1985">1985</option><option value="1984">1984</option><option value="1983">1983</option><option value="1982">1982</option><option value="1981">1981</option><option value="1980">1980</option><option value="1979">1979</option><option value="1978">1978</option><option value="1977">1977</option><option value="1976">1976</option><option value="1975">1975</option><option value="1974">1974</option><option value="1973">1973</option><option value="1972">1972</option><option value="1971">1971</option><option value="1970">1970</option><option value="1969">1969</option><option value="1968">1968</option><option value="1967">1967</option><option value="1966">1966</option><option value="1965">1965</option><option value="1964">1964</option><option value="1963">1963</option><option value="1962">1962</option><option value="1961">1961</option><option value="1960">1960</option><option value="1959">1959</option><option value="1958">1958</option><option value="1957">1957</option><option value="1956">1956</option><option value="1955">1955</option><option value="1954">1954</option><option value="1953">1953</option><option value="1952">1952</option><option value="1951">1951</option><option value="1950">1950</option><option value="1949">1949</option><option value="1948">1948</option><option value="1947">1947</option><option value="1946">1946</option><option value="1945">1945</option><option value="1944">1944</option><option value="1943">1943</option><option value="1942">1942</option><option value="1941">1941</option><option value="1940">1940</option><option value="1939">1939</option><option value="1938">1938</option><option value="1937">1937</option><option value="1936">1936</option><option value="1935">1935</option><option value="1934">1934</option><option value="1933">1933</option><option value="1932">1932</option><option value="1931">1931</option><option value="1930">1930</option><option value="1929">1929</option><option value="1928">1928</option><option value="1927">1927</option><option value="1926">1926</option><option value="1925">1925</option><option value="1924">1924</option><option value="1923">1923</option><option value="1922">1922</option><option value="1921">1921</option><option value="1920">1920</option><option value="1919">1919</option><option value="1918">1918</option><option value="1917">1917</option><option value="1916">1916</option><option value="1915">1915</option><option value="1914">1914</option><option value="1913">1913</option>
                                  </select>
                                </div>
                              </div>
                              <!---->
                                <!---->
                                  <!---->
                                
                                <!---->
                              
                              <!---->
                            </div>
                          </div>
                        </div>
                        <hr class="small">
                        <div class="form-group col-sm-4 lang">
                          <label class="control-label">My Preferred Language</label>
                          <select asp-for="lang" id="myselect"  class="form-control inline ng-untouched ng-pristine ng-valid">
                               @if (ViewBag.personal.LanguageId != null)
                                                            {
                                                                 <option value="ViewBag.personal.LanguageId"></option>
                                                            }
                                                            else
                                                            {
                                                                 <option value="1">English</option>
                                                            }
                            <!----><option value="1">English</option>
                            <option value="2">German</option>
                            
                          </select>
                        </div>
                        <button class="btn " type="submit" id="save-btn">Save</button>
                      </form>
                  </div>
                  <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="service-provider">
                      <div role="alert" class="alert alert-success " id="closebtn1">
                      <button  class="close" type="button" onclick="document.getElementById('closebtn1').style.display='none'">
                        <span aria-hidden="true">×</span>
                      </button>
                      <span class="break-word" >Added Successfully!!</span>
                    </div>
                    <div role="alert" class="alert alert-success " id="closebtn2">
                      <button  class="close" type="button" onclick="document.getElementById('closebtn2').style.display='none'">
                        <span aria-hidden="true">×</span>
                      </button>
                      <span class="break-word" >Deleted Successfully!!</span>
                    </div>
                    <div role="alert" class="alert alert-success " id="closebtn3">
                      <button  class="close" type="button" onclick="document.getElementById('closebtn3').style.display='none'">
                        <span aria-hidden="true">×</span>
                      </button>
                      <span class="break-word" >Updated Successfully!!</span>
                    </div>
                    <table>
                        <thead>
                          <tr>
                           
                            <th>Addresses</th>
                            <th class="text-center">Action</th>
                          </tr>
                        </thead>
                        <tbody>
                                        @foreach(UserAddress ua in Model.userAddresses){
                                            var addressid = @ua.AddressId;
                                            <tr>
                              
                                              <td class="contact">
                                                <span>
                                                  <b>Address:</b> @ua.AddressLine2,@ua.AddressLine1</span>
                                               
                                                        @if (ua.Mobile != null)
                                                        {
                                                             <span><b>Phone number:</b>@ua.Mobile</span>
                                                        }
                                                       
                                              </td>
                                              <td class="text-center action-buttons">
                                                <a title="Edit" onclick="editadd(@addressid)">
                                                  <img src="~/assets/edit-icon.png" alt="Edit">
                                                </a>
                                                <a title="Delete" onclick="deleteadd(@addressid)">
                                                  <img src="~/assets/delete-icon.png" alt="Delete">
                                                </a>
                                              </td>
                                            </tr>
                                            <div id="@addressid" class="modal ">
            
            <div class="modal-content animate edit-address"  >
                <p class="login">Edit Address <i class="fa fa-close float-right" 
                    onclick="document.getElementById('@addressid').style.display='none'"></i></p>
                    <form asp-action="editaddress">
                         
                        <div class="container">
                           
                             <input type="hidden" id="deleteaddid1" asp-for="deleteaddid" value="@addressid"/>
                    <div class="form-row">
                        <div class="col">
                          <label>Street Name</label>
                      <input type="text" asp-for="myaddress.AddressLine2" value="@ua.AddressLine1" class="form-control add-form-input" 
                      placeholder="Street Name" required >
                     
                    </div>
                    <div class="col">
                      <label>House Number</label>
                      <input type="text" asp-for="myaddress.AddressLine1" value="@ua.AddressLine2" class="form-control add-form-input"
                      placeholder="House Number"  required>
                       
                    </div>
                    </div>
                    <div class="form-row">
                        <div class="col">
                          <label>Postal code</label>
                      <input type="text" asp-for="myaddress.PostalCode" value="@ua.PostalCode" class="form-control add-form-input" 
                      placeholder="Postal Code"  required>
                       
                    </div>
                    <div class="col">
                      <label>City</label>
                      <input type="text" asp-for="myaddress.City" value="@ua.City" class="form-control add-form-input" 
                      placeholder="City" required >
                      
                       
                    </div>
                    </div>
                      <div class="form-row ">
                          <div class="col ">
                            <label>Phone Number</label>
                              <div class="input-group mb-2">
                              <div class="input-group-prepend">
                                  <div class="input-group-text">+91</div>
                                </div>
                                @if(ua.Mobile!=null){
                                    <input asp-for="myaddress.Mobile" value="@ua.Mobile" class="form-control" id="myphone" placeholder="Phone Number"
                                 >
                                }
                                 else
                                  {
                                        <input asp-for="myaddress.Mobile" class="form-control" id="myphone" placeholder="Phone Number"
                                 >                                
                                  }
                               
                              </div>
                        
                      </div>
                      <div class="col"></div>                               
                      </div>
                  <div class="container text-center">
                   
                    <button type="submit"  class="btn login-btn"  >Edit</button>
                 </div>
                   </div>
                    </form>
                        
                   
                
                    
            </div>
          </div>
                                        }
                                        
                          
                         
                        </tbody>
                      </table>
                      <button class="btn " type="submit" id="save-btn" onclick="document.getElementById('add').style.display='block'">Add New Address</button>
                  </div>
                  <div class="tab-pane fade" id="hello" role="tabpanel" aria-labelledby="hello1">
                      <div role="alert" class="alert alert-success " id="closebtn4">
                      <button  class="close" type="button" onclick="document.getElementById('closebtn4').style.display='none'">
                        <span aria-hidden="true">×</span>
                      </button>
                      <span class="break-word" >Updated Successfully!!</span>
                    </div>
                    <div role="alert" class="alert alert-success " style="background:rgba(255,0,0, 0.5);" id="closebtn5">
                      <button  class="close" type="button" onclick="document.getElementById('closebtn5').style.display='none'">
                        <span aria-hidden="true">×</span>
                      </button>
                      <span class="break-word" style="color:white" >Please enter valid old password!!</span>
                    </div>
                    <form  class="ng-untouched ng-pristine ng-valid cngpassword" asp-action="changeUserPassword">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label mt-3">Old Password</label>
                              <input asp-for="oldpassword" class="form-control ng-untouched ng-pristine ng-invalid" formcontrolname="oldpwd" maxlength="20" type="password" 
                              placeholder="Current Password">
                              <span asp-validation-for="oldpassword" class="text-danger"></span>
                              <!---->
                            </div>
                          </div>
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label ">New Password</label>
                              <input asp-for="Password" class="form-control ng-untouched ng-pristine ng-invalid" formcontrolname="pwd" maxlength="20" type="password" placeholder="Password">
                              <span asp-validation-for="Password" class="text-danger"></span>
                            </div>
                          </div>
                          <div class="col-sm-4">
                            <div class="form-group">
                              <label class="control-label ">Confirm Password</label>
                              <input asp-for="Confirmpwd" class="form-control ng-untouched ng-pristine ng-invalid" formcontrolname="confirmPwd" maxlength="20" type="password" placeholder="Confirm Password">
                              <span asp-validation-for="Confirmpwd" class="text-danger"></span>
                            </div>
                          </div>
                          <button class="btn" type="submit" id="save-btn">Save</button>
                          </form>
                  </div>
                </div>
            </div>
              </div>
              </div>
              </div>
              </div>
              </div>

@if (TempData["personald"] != null)
{
    <script>
        $("#closebtn").show().delay(5000).fadeOut();
       
    </script>
}
@if(TempData["changepass"] != null)
{
    <script>
    $("#hello1").trigger("click");
    $("#closebtn4").show().delay(5000).fadeOut();
    </script>
}
@if(TempData["errorchangepass"] != null)
{
    <script>
    $("#hello1").trigger("click");
    $("#closebtn5").show().delay(5000).fadeOut();
    </script>
}
@if( TempData["newadd"] != null)
{
    <script>
    $("#service-provider").trigger("click");
    $("#closebtn1").show().delay(5000).fadeOut();
    </script>
}
@if(TempData["deleteadd"] != null)
{
    <script>
    $("#service-provider").trigger("click");
    $("#closebtn2").show().delay(5000).fadeOut();
    </script>
}
@if(TempData["editadd"] != null)
{
    <script>
    $("#service-provider").trigger("click");
    $("#closebtn3").show().delay(5000).fadeOut();
    </script>
}
@if(ViewBag.personal.LanguageId!=null){
                   <script>
                $(document).ready(function () {

                    $('#myselect option[value="@ViewBag.personal.LanguageId"]').prop('selected', 'selected').change();
                });
    </script>
               }
<script>
    function deleteadd(x){
        document.getElementById('deleteadd').style.display='block';
        document.getElementById('deleteaddid').value=x;
       
    }
    function editadd(addressid){
        document.getElementById(addressid).style.display='block';
        document.getElementById('deleteaddid1').value=addressid;
    }
</script>
@section scripts{  
     @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
 }